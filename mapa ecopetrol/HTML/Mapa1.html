<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Display buildings in 3D</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 80%; }
.menu { position: absolute; top: 10px; left: 10px; z-index: 1; }
.menu ul { list-style-type: none; padding: 0; }
.menu li { margin-bottom: 5px; cursor: pointer; }
.menu li:hover { color: rgb(0, 0, 0); }
.popup { animation: fadeIn 0.5s forwards; }
.popup-content { padding: 10px; }
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>
</head>
<body>
<div id="map"></div>
<div class="menu">
  <h2>Destinos</h2>
  <ul>
    <li onclick="goToMarker([-75.6115, 6.2311])">Udem</li>
    <li onclick="goToMarker([-75.612, 8.232])">Udem1</li>
    <!-- Agrega más opciones de menú aquí si es necesario -->
  </ul>
</div>
<table id="markerTable">
  <thead>
    <tr>
      <th>Titulo</th>
      <th>Coordenadas</th>
    </tr>
  </thead>
  <tbody>
    <!-- Aquí se agregarán los marcadores dinámicamente -->
  </tbody>
</table>

<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoicnl1amluaGlyYWdpIiwiYSI6ImNsc3hkbmdmazAxeTYyaW1jMjZ5ejBwYTgifQ.tXxXC8eIOK7j6g1EXS2lfw';
const map = new mapboxgl.Map({
    style: 'mapbox://styles/mapbox/light-v11',
    center: [-75.6115, 6.2311],
    zoom: 15.5,
    pitch: 45,
    bearing: -17.6,
    container: 'map',
    antialias: true
});

map.on('style.load', () => {
    const layers = map.getStyle().layers;
    const labelLayerId = layers.find(
        (layer) => layer.type === 'symbol' && layer.layout['text-field']
    ).id;

    map.addLayer(
        {
            'id': 'add-3d-buildings',
            'source': 'composite',
            'source-layer': 'building',
            'filter': ['==', 'extrude', 'true'],
            'type': 'fill-extrusion',
            'minzoom': 15,
            'paint': {
                'fill-extrusion-color': '#aaa',
                'fill-extrusion-height': ['interpolate', ['linear'], ['zoom'], 15, 0, 15.05, ['get', 'height']],
                'fill-extrusion-base': ['interpolate', ['linear'], ['zoom'], 15, 0, 15.05, ['get', 'min_height']],
                'fill-extrusion-opacity': 0.6
            }
        },
        labelLayerId
    );

    // Agregar un marcador con ventana emergente
    var marker = new mapboxgl.Marker({ color: 'red' }) // Cambiar el color a rojo
        .setLngLat([-75.6115, 6.2311])
        .addTo(map)
        .setPopup(new mapboxgl.Popup({ className: 'popup' }).setHTML("<div class='popup-content'><h3>Información del Marcador</h3><p>Aquí puedes agregar información relevante sobre el marcador.</p></div>"));

    // Mostrar ventana emergente al hacer hover sobre el marcador
    marker.getElement().addEventListener('mouseenter', () => marker.togglePopup());
    marker.getElement().addEventListener('mouseleave', () => marker.togglePopup());

    // Agregar otro marcador
    var marker2 = new mapboxgl.Marker({ color: 'blue' }) // Cambiar el color a azul
        .setLngLat([-75.612, 6.232])
        .addTo(map)
        .setPopup(new mapboxgl.Popup({ className: 'popup' }).setHTML("<div class='popup-content'><h3>Información del Segundo Marcador</h3><p>Aquí puedes agregar información relevante sobre el segundo marcador.</p></div>"));

    // Mostrar ventana emergente al hacer hover sobre el segundo marcador
    marker2.getElement().addEventListener('mouseenter', () => marker2.togglePopup());
    marker2.getElement().addEventListener('mouseleave', () => marker2.togglePopup());
        
    // Agregar otro marcador y también agregarlo a la tabla
    var marker3 = new mapboxgl.Marker({ color: 'green' }) // Cambiar el color a verde
        .setLngLat([-75.612, 8.232])
        .addTo(map)
        .setPopup(new mapboxgl.Popup({ className: 'popup' }).setHTML("<div class='popup-content'><h3>Información del Tercer Marcador</h3><p>Aquí puedes agregar información relevante sobre el tercer marcador.</p></div>"));

    // Mostrar ventana emergente al hacer hover sobre el tercer marcador
    marker3.getElement().addEventListener('mouseenter', () => marker3.togglePopup());
    marker3.getElement().addEventListener('mouseleave', () => marker3.togglePopup());

    // Agregar el marcador a la tabla
    addToTable("Tercer Marcador", [-75.612, 8.232]);
});

// Función para ir a un marcador específico
function goToMarker(coordinates) {
    map.flyTo({
        center: coordinates,
        zoom: 15,
        speed: 1.5,
        curve: 1,
        easing: (t) => t
    });
}

// Función para agregar un marcador a la tabla
function addToTable(title, coordinates) {
    var tableBody = document.querySelector('#markerTable tbody');   
    var newRow = tableBody.insertRow();

    var titleCell = newRow.insertCell(0);
    titleCell.textContent = title;

    var coordCell = newRow.insertCell(1);
    coordCell.textContent = coordinates.toString();
}
</script>
</body>
</html>
